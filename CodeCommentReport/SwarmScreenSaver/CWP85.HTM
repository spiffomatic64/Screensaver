<!-- saved from url=(0014)about:Swarm -->
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>SwarmScreenSaver.ScreenSaver</TITLE>
<LINK REL=STYLESHEET HREF="../CommentReport.css" TYPE="text/css">
</HEAD>
<BODY topmargin=0 rightmargin=0 leftmargin=0 style="background-image: url(../titletile.jpg); background-repeat:repeat-x; background-position: 0 0;" >
<DIV CLASS="PageHeading">SwarmScreenSaver.ScreenSaver Class</DIV>
<DIV CLASS="Description">

This class handles the running of the screensaver in fullscreen mode.
<P>

</DIV>
<IMG src="../GradLeft.jpg" width=7 height=378 alt="" border="0" style="position:absolute; left:10; top:18;z-Index:2">
<IMG src="../GradTop.jpg" width=352 height=7 alt="" border="0" align="top" style="position:absolute; left:10; top:18; z-index:1">
<DIV CLASS="Remarks">
<SPAN CLASS="RemarkHdrX">Access: </SPAN>Public</DIV>
<DIV CLASS="Remarks">
<SPAN CLASS="RemarkHdrX">Base Classes: </SPAN>Object</DIV>
<TABLE CLASS="InfoTable" cellpadding=0 cellspacing=0>
<TR height=20>
<TD width=20>&nbsp;</TD>
<TD valign=top align=left width=9 bgcolor="#cccc66"><IMG SRC="../graycorner.jpg" align=top></TD>
<TD CLASS="TableLightLabel" WIDTH=206>Members</TD>
<TD CLASS="TableLightLabel" >Description</TD>
<TD width=20>&nbsp;</TD>
</TR>
<TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP86.HTM" TARGET="CNTFRAME">DonePaintingDel</A></TD>
<TD CLASS="TableLightDesc">
A variable used to pass the name of the method that informs this class<br>
that the form is finished painting to a ScreenSaverForm as a delagate.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP88.HTM" TARGET="CNTFRAME">ShutDownDel</A></TD>
<TD CLASS="TableLightDesc">
A variable used to pass the name of the method that informs this class<br>
that the app should shut down to a ScreenSaverForm as a delagate.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP90.HTM" TARGET="CNTFRAME">screenCount</A></TD>
<TD CLASS="TableLightDesc">
A count of the open screens.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP91.HTM" TARGET="CNTFRAME">shuttingDown</A></TD>
<TD CLASS="TableLightDesc">
False if not shutting down.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP92.HTM" TARGET="CNTFRAME">sf</A></TD>
<TD CLASS="TableLightDesc">
An array of ScreenSaverForms. To be initialized later.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP94.HTM" TARGET="CNTFRAME">ScreenDonePainting</A></TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP95.HTM" TARGET="CNTFRAME">manualEvents</A></TD>
<TD CLASS="TableLightDesc">
This is used to stop the main thread from eating up CPU cycles waiting for an event.
I use a call to WaitHandle.WaitForAny(manualEvents); to wait for the event.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP96.HTM" TARGET="CNTFRAME">ScreenSaver</A></TD>
<TD CLASS="TableLightDesc">
Constructor creates a manualEvent for each screen and one more for shutting down.
then it initializes the event to untriggered. The delegates below signal the event
as happened, so that the main thread's while loop continues when an event happens.
Additionally, I have utilized ManualEvents to cause my while loop to stop looping
and wait for an event to be fired instead of looping uselessly, the wait stops the
thread until an event fires to respond to. This dramatically lessens the load on the
CPU, that was wasted in looping over and over while waiting for an event. This was 
causing the InvalidOperationEvent error that was taking place because it was tying up
the OS looping all the time. I could not put in an Application.DoEvent() call because
it was interrupting the drawing and causing bad flicker. Instead, now that the main 
thread goes to sleep, I have accomplished the same thing, by freeing up the load the 
screensaver was putting on the computer cpu just looping.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP97.HTM" TARGET="CNTFRAME">CloseAllScreens</A></TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP98.HTM" TARGET="CNTFRAME">~ScreenSaver</A></TD>
<TD CLASS="TableLightDesc">
Just to make sure all screens are shut down.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP99.HTM" TARGET="CNTFRAME">DonePainting</A></TD>
<TD CLASS="TableLightDesc">
This is passed to ScreenSaverForm as a delegate so the form<br>
can call this to let this class know that the form is done painting.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP100.HTM" TARGET="CNTFRAME">ifPaintDoneResetStatuses</A></TD>
<TD CLASS="TableLightDesc">
Sometimes we get foreign paints, we need to reset the screen
as unpainted if this happenes and reset our event handler to
wait.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP101.HTM" TARGET="CNTFRAME">ShutDown</A></TD>
<TD CLASS="TableLightDesc">
This is passed to ScreenSaverForms as a delegate to be called when the app<br>
should shut down.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR><TR height=20>
<TD width=20>&nbsp;</TD>
<TD CLASS="TableLightDesc">&nbsp;</TD>
<TD CLASS="TableLightDesc"><A HREF="CWP102.HTM" TARGET="CNTFRAME">RunMeTillShutdown</A></TD>
<TD CLASS="TableLightDesc">
This method handles the actual screensaving until it's time to shut down.
<P>
</TD>
<TD width=20>&nbsp;</TD>
</TR></TABLE>
</BODY>
</HTML>
